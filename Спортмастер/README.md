# Задание для Аналитика
**Компания:** Спортмастер   
**Уровень:** Junior         
**Навыки:** SQL   

# Анализ клиентской активности

## Задача 1  
Найти **средний оборот на одного клиента** и **среднюю частоту покупок** в течение 1 года с момента первого указания email в личном кабинете.  

**Условие:**  
- Учитываются только клиенты, которые впервые указали email в сентябре 2019 года.

---

### Ожидаемый результат  

Пример:  

| Средний оборот на клиента | Частота покупок |
|---------------------------|-----------------|
| 8765.987879879...         | 9.0234235225... |

---

### Данные  

В анализе используются две таблицы:  

#### 1. `table_ident` (Идентификаторы клиентов)  
Содержит информацию об идентификаторах клиентов.  

| Поле         | Описание                          |
|--------------|-----------------------------------|
| `id_client`  | Уникальный код клиента           |
| `ident_type` | Тип идентификатора               |
| `dat_inserted` | Дата указания идентификатора    |
| `ident`      | Идентификатор клиента            |

Пример данных:  

| id_client | ident_type | dat_inserted       | ident          |
|-----------|------------|--------------------|----------------|
| 423       | Телефон    | 1/13/21 14:13      | 89994567813    |
| 1056      | Email      | 9/12/19 10:45      | ivan@mail.ru   |
| 787       | Email      | 2/25/20 15:19      | aaa@yandex.ru  |

---

#### 2. `table_sales` (Продажи)  
Содержит данные о транзакциях.  

| Поле        | Описание                          |
|-------------|-----------------------------------|
| `id_client` | Уникальный код клиента           |
| `id_check`  | Уникальный код чека покупки      |
| `sales`     | Продажи в рублях                 |
| `channel`   | Источник заказа/покупки          |
| `dat_check` | Дата транзакции                  |

Пример данных:  

| id_client | id_check       | sales  | channel | dat_check        |
|-----------|----------------|--------|---------|------------------|
| 423       | 142421421421   | 1099   | Магазин | 7/13/21 18:01    |
| 1056      | 213687243978   | 98765  | Магазин | 7/17/21 18:29    |
| 1234      | 987654321798   | 1234   | МП      | 9/16/21 20:01    |

---

## Задача 2  
Посчитать сумму продаж по 100-му магазину за 1 января 2013 года.  

---

### Исходные данные  

Есть две таблицы:  

#### 1. `sales` (таблица продаж)  
Содержит информацию о дате покупки, номере магазина, артикуле и количестве проданных штук.  

| Поле       | Описание                          |
|------------|-----------------------------------|
| `datetime` | Дата и время покупки             |
| `shop`     | Номер магазина                   |
| `art`      | Артикул                          |
| `quantity` | Количество проданных штук        |

Пример данных:  

| datetime          | shop | art | quantity |
|--------------------|------|-----|----------|
| 01-01-13 12:12:12 | 100  | A1  | -2       |
| 01-01-13 12:12:13 | 100  | A1  | 3        |
| 01-01-13 12:12:14 | 100  | A1  | 4        |
| 01-01-13 12:12:15 | 100  | A1  | 5        |

#### 2. `prices` (справочник цен)  
Содержит информацию о цене всех артикулов из таблицы продаж.  

| Поле   | Описание         |
|--------|------------------|
| `art`  | Артикул          |
| `price`| Цена за единицу  |

Пример данных:  

| art | price |
|-----|-------|
| A1  | 10    |
| A2  | 20    |
| A3  | 30    |

---

### Решение  

1. Соединить таблицы `sales` и `prices` по полю `art`.
2. Отфильтровать данные по номеру магазина (`shop = 100`) и дате (`datetime` = 01-01-13).
3. Вычислить сумму продаж как произведение `quantity` на `price`.
