**ЗАДАЧА 1:**
Посчитать в одном запросе:
- количество просмотров (1 строка в таблице - 1 просмотр) видео по дням
- размер аудитории (уникальное кол-во пользователей) по дням
- полученную таблицу отсортировать по дате

Для выполнения этой задачи нужно посчитать:
1. Количество просмотров по дням (одна строка таблицы — это один просмотр).
2. Количество уникальных пользователей (размер аудитории) по дням.
3. Нужно использовать запрос с COUNT для количества просмотров и COUNT(DISTINCT) для подсчета уникальных пользователей.

SELECT date,COUNT(*) AS total_views,  -- Количество просмотров
COUNT(DISTINCT user_id) AS unique_users  -- Уникальные пользователи
FROM reports_stg.watch_content
GROUP BY date
ORDER BY date;

**ЗАДАЧА 2:**
Вывести список пользователей, смотревших видео каждый день в январе 2021
Решение:
Для решения этой задачи нужно выбрать всех пользователей, которые смотрели хотя бы одно видео каждый день в январе 2021 года. 
Выберем просмотры в январе 2021 года.
1. Посчитаем количество уникальных дат, когда пользователи смотрели видео.
2. Сравним это количество с числом дней в январе 2021 (31 день).

WITH january_views AS (
SELECT user_id, date
FROM reports_stg.watch_content
WHERE date BETWEEN '2021-01-01' AND '2021-01-31'
GROUP BY user_id, date),
user_activity AS (
SELECT user_id, COUNT(DISTINCT date) AS active_days
FROM january_views
GROUP BY user_id)
SELECT user_id
FROM user_activity
WHERE active_days = 31;  -- 31 день в январе

Пояснение: 
WITH january_views AS (...) — временная таблица, которая выбирает всех пользователей, смотревших видео в январе 2021 года, и уникальные даты их активности.
user_activity — подсчитывает количество дней, когда каждый пользователь был активен (смотрел хотя бы одно видео).
active_days = 31 — фильтр, который выбирает только тех пользователей, у кого количество активных дней равно 31 (все дни января).
 
**ЗАДАЧА 3**
Написать функцию, которая принимает на вход число, возвращает ответ:
“простое” - если число простое, “не простое” - если число не простое.
Простое число — это натуральное число больше 1, у которого есть всего два делителя: единица и
само число.

Решение:
Простое число — это число, которое делится только на 1 и на само себя. Чтобы проверить, является ли число простым:
Если число меньше 2, оно не может быть простым.
Пройдем по всем числам от 2 до квадратного корня числа и проверим, делится ли данное число на них без остатка. 
Если делится — число не простое.

def is_prime(n):
    # Если число меньше 2, оно не простое
    if n < 2:
        return "не простое"
    
    # Проверяем делимость числа на все числа от 2 до √n
    for i in range(2, int(math.sqrt(n)) + 1):
        if n % i == 0:
            return "не простое"
    
    # Если не нашлось делителей, число простое
    return "простое"

Пояснение:
n < 2 — числа меньше 2 не являются простыми.
math.sqrt(n) — для оптимизации мы проверяем делимость только до квадратного корня числа, поскольку множители числа после его квадратного корня симметричны.
n % i == 0 — если число делится на какое-то число от 2 до √n без остатка, то оно не простое.
Если делителей не нашлось, возвращаем "простое".
